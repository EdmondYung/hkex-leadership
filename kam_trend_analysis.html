<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KAM Trend Analysis 2015-2024 | Global Stock Exchanges</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 40px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        .header h1 {
            font-size: 2.5em;
            color: #2c3e50;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header .subtitle {
            font-size: 1.2em;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        .header .meta {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .meta-item {
            background: #3498db;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: 600;
        }

        .section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        .section h2 {
            color: #2c3e50;
            font-size: 1.8em;
            margin-bottom: 20px;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }

        .section h3 {
            color: #34495e;
            font-size: 1.4em;
            margin: 25px 0 15px 0;
        }

        .section h4 {
            color: #7f8c8d;
            font-size: 1.2em;
            margin: 20px 0 10px 0;
        }

        .chart-container {
            position: relative;
            height: 400px;
            margin: 30px 0;
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .chart-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 30px;
            margin: 30px 0;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .timeline {
            position: relative;
            margin: 40px 0;
        }

        .timeline-item {
            display: flex;
            margin-bottom: 30px;
            position: relative;
        }

        .timeline-year {
            background: #3498db;
            color: white;
            padding: 10px 15px;
            border-radius: 25px;
            font-weight: 600;
            min-width: 80px;
            text-align: center;
            margin-right: 20px;
        }

        .timeline-content {
            flex: 1;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #3498db;
        }

        .phase-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 30px 0 20px 0;
        }

        .phase-header h3 {
            color: white;
            margin: 0;
        }

        .highlight-box {
            background: #e8f4fd;
            border-left: 4px solid #3498db;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .exchange-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 5px solid #3498db;
        }

        .exchange-name {
            font-size: 1.3em;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .kam-count {
            background: #3498db;
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9em;
            display: inline-block;
            margin-bottom: 10px;
        }

        .navigation {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        .nav-link {
            display: block;
            color: #3498db;
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 5px;
            margin: 2px 0;
            font-size: 0.9em;
        }

        .nav-link:hover {
            background: #3498db;
            color: white;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .chart-grid {
                grid-template-columns: 1fr;
            }
            
            .navigation {
                display: none;
            }
            
            .header .meta {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="navigation">
        <a href="#overview" class="nav-link">üìä Overview</a>
        <a href="#trends" class="nav-link">üìà Trends</a>
        <a href="#phases" class="nav-link">üîÑ Phases</a>
        <a href="#exchanges" class="nav-link">üè¢ Exchanges</a>
        <a href="#insights" class="nav-link">üí° Insights</a>
        <a href="kam-analysis.html" class="nav-link">üîô Dashboard</a>
    </div>

    <div class="container">
        <div class="header">
            <h1>üìä KAM Trend Analysis 2015-2024</h1>
            <div class="subtitle">Comprehensive Analysis of Key Audit Matters Across Global Stock Exchanges</div>
            <div class="meta">
                <div class="meta-item">131 Total KAMs</div>
                <div class="meta-item">7 Major Exchanges</div>
                <div class="meta-item">10-Year Period</div>
                <div class="meta-item">4 Distinct Phases</div>
            </div>
        </div>

        <section id="overview" class="section">
            <h2>üìà Executive Summary</h2>
            <p>This comprehensive analysis examines Key Audit Matters (KAMs) across seven major global stock exchanges from 2015-2024, revealing distinct phases of complexity driven by mega-acquisitions, technology transformation, and regulatory evolution.</p>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">131</div>
                    <div class="stat-label">Total KAMs Analyzed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">2021</div>
                    <div class="stat-label">Peak Complexity Year</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">$58B+</div>
                    <div class="stat-label">Major Acquisitions Value</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">35%</div>
                    <div class="stat-label">High Risk KAMs (2021)</div>
                </div>
            </div>

            <div class="chart-container">
                <canvas id="overviewChart"></canvas>
            </div>
        </section>

        <section id="trends" class="section">
            <h2>üìä Detailed Year-by-Year Analysis</h2>

            <div class="chart-grid">
                <div class="chart-container">
                    <canvas id="yearTrendChart"></canvas>
                </div>
                <div class="chart-container">
                    <canvas id="companyDistributionChart"></canvas>
                </div>
            </div>

            <div class="timeline">
                <div class="timeline-item">
                    <div class="timeline-year">2015</div>
                    <div class="timeline-content">
                        <strong>5 KAMs (3.8%)</strong> - Foundation Period
                        <p>Pre-MiFID II era with traditional audit focus on basic goodwill and revenue recognition matters.</p>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-year">2016</div>
                    <div class="timeline-content">
                        <strong>9 KAMs (6.9%)</strong> - Early Growth
                        <p>Preparation for regulatory changes and initial technology investments driving complexity.</p>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-year">2017</div>
                    <div class="timeline-content">
                        <strong>12 KAMs (9.2%)</strong> - Acceleration Begins
                        <p>Deutsche B√∂rse expansion and early acquisition activities increasing audit complexity.</p>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-year">2018</div>
                    <div class="timeline-content">
                        <strong>13 KAMs (9.9%)</strong> - Regulatory Revolution
                        <p><strong>MiFID II Implementation</strong> and GDPR launch creating massive compliance requirements.</p>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-year">2019</div>
                    <div class="timeline-content">
                        <strong>14 KAMs (10.7%)</strong> - Strategic Positioning
                        <p><strong>LSEG-Refinitiv Deal Announced</strong> ($27B) creating significant valuation complexities.</p>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-year">2020</div>
                    <div class="timeline-content">
                        <strong>15 KAMs (11.5%)</strong> - COVID-19 Disruption
                        <p>Market volatility, remote operations, and technology resilience becoming critical audit areas.</p>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-year">2021</div>
                    <div class="timeline-content">
                        <strong>17 KAMs (13.0%)</strong> - Peak Complexity
                        <p><strong>Mega-Acquisition Year:</strong> LSEG-Refinitiv completion, Euronext-Borsa Italiana ($4.3B).</p>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-year">2022</div>
                    <div class="timeline-content">
                        <strong>15 KAMs (11.5%)</strong> - Integration Challenges
                        <p>Technology platform mergers and regulatory harmonization across acquired entities.</p>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-year">2023</div>
                    <div class="timeline-content">
                        <strong>17 KAMs (13.0%)</strong> - New Peak
                        <p><strong>Deutsche B√∂rse-SimCorp</strong> completion ($3.9B) and AI/technology focus intensification.</p>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-year">2024</div>
                    <div class="timeline-content">
                        <strong>14 KAMs (10.7%)</strong> - Stabilization
                        <p>Post-acquisition integration optimization and technology deployment focus.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="phases" class="section">
            <h2>üîÑ Four Distinct Phases of Evolution</h2>

            <div class="phase-header">
                <h3>Phase 1: Foundation Period (2015-2017)</h3>
                <p>26 KAMs (19.8%) - Traditional audit focus with limited technology complexity</p>
            </div>

            <div class="highlight-box">
                <h4>Key Characteristics:</h4>
                <ul>
                    <li><strong>Lower Complexity:</strong> Fewer, more traditional audit matters</li>
                    <li><strong>Focus Areas:</strong> Basic goodwill impairment, revenue recognition</li>
                    <li><strong>Technology:</strong> Limited technology-related KAMs</li>
                    <li><strong>Context:</strong> Pre-MiFID II era, traditional trading dominance</li>
                </ul>
            </div>

            <div class="phase-header">
                <h3>Phase 2: Transformation Acceleration (2018-2020)</h3>
                <p>42 KAMs (32.1%) - Regulatory revolution and strategic positioning</p>
            </div>

            <div class="highlight-box">
                <h4>Major Developments:</h4>
                <ul>
                    <li><strong>2018:</strong> MiFID II implementation, GDPR launch</li>
                    <li><strong>2019:</strong> LSEG-Refinitiv $27B deal announced</li>
                    <li><strong>2020:</strong> COVID-19 disruption, market volatility</li>
                </ul>
                <h4>Emerging KAM Themes:</h4>
                <ul>
                    <li>Technology platform valuations</li>
                    <li>Regulatory compliance costs</li>
                    <li>Business continuity assessments</li>
                    <li>Market risk impact on revenue</li>
                </ul>
            </div>

            <div class="chart-container">
                <canvas id="phaseChart"></canvas>
            </div>

            <div class="phase-header">
                <h3>Phase 3: Peak Complexity Period (2021-2023)</h3>
                <p>49 KAMs (37.4%) - Mega-acquisitions and integration challenges</p>
            </div>

            <div class="highlight-box">
                <h4>2021: Mega-Acquisition Year</h4>
                <ul>
                    <li><strong>LSEG-Refinitiv:</strong> $27 billion completion (January 2021)</li>
                    <li><strong>Euronext-Borsa Italiana:</strong> ‚Ç¨4.3 billion completion (April 2021)</li>
                    <li><strong>Deutsche B√∂rse-SimCorp:</strong> Acquisition discussions intensified</li>
                </ul>
                <h4>Dominant KAM Categories:</h4>
                <ul>
                    <li><strong>Acquisition Accounting (25-30%):</strong> Purchase price allocations, goodwill</li>
                    <li><strong>Technology Valuations (20-25%):</strong> Platform integrations, AI investments</li>
                    <li><strong>Regulatory Compliance (15-20%):</strong> Cross-border harmonization</li>
                    <li><strong>Revenue Recognition (15-20%):</strong> Complex multi-stream models</li>
                </ul>
            </div>

            <div class="phase-header">
                <h3>Phase 4: Stabilization Period (2024)</h3>
                <p>14 KAMs (10.7%) - Post-acquisition optimization and technology deployment</p>
            </div>
        </section>

        <section id="exchanges" class="section">
            <h2>üè¢ Exchange-Specific Analysis</h2>

            <div class="chart-grid">
                <div class="chart-container">
                    <canvas id="exchangeKAMChart"></canvas>
                </div>
                <div class="chart-container">
                    <canvas id="riskSeverityChart"></canvas>
                </div>
            </div>

            <div class="exchange-card">
                <div class="exchange-name">üá¨üáß LSEG (London Stock Exchange Group)</div>
                <div class="kam-count">36 KAMs (27.5%)</div>
                <h4>Transformation Journey:</h4>
                <ul>
                    <li><strong>2019-2021:</strong> Refinitiv acquisition dominated KAMs</li>
                    <li><strong>2022-2024:</strong> Integration and optimization focus</li>
                </ul>
                <h4>Major KAM Themes:</h4>
                <ul>
                    <li><strong>Goodwill Impairment:</strong> ¬£15+ billion goodwill from acquisitions</li>
                    <li><strong>Technology Integration:</strong> Merging trading platforms</li>
                    <li><strong>Data Business Valuation:</strong> Refinitiv data assets</li>
                    <li><strong>Regulatory Capital:</strong> Post-trade service requirements</li>
                </ul>
            </div>

            <div class="exchange-card">
                <div class="exchange-name">üá™üá∫ Euronext N.V.</div>
                <div class="kam-count">34 KAMs (26.0%)</div>
                <h4>Pan-European Consolidation:</h4>
                <ul>
                    <li><strong>2020-2021:</strong> Borsa Italiana acquisition</li>
                    <li><strong>2022-2024:</strong> Pan-European platform consolidation</li>
                </ul>
                <h4>Key Focus Areas:</h4>
                <ul>
                    <li><strong>Cross-Border Integration:</strong> Harmonizing 7 national markets</li>
                    <li><strong>Technology Standardization:</strong> Single platform deployment</li>
                    <li><strong>Regulatory Harmonization:</strong> Multiple jurisdiction compliance</li>
                    <li><strong>Market Data Consolidation:</strong> Unified data services</li>
                </ul>
            </div>

            <div class="exchange-card">
                <div class="exchange-name">üá©üá™ Deutsche B√∂rse AG</div>
                <div class="kam-count">19 KAMs (14.5%)</div>
                <h4>Investment Management Focus:</h4>
                <ul>
                    <li><strong>2019-2023:</strong> SimCorp acquisition and integration</li>
                    <li><strong>Strategic Focus:</strong> Investment management solutions expansion</li>
                </ul>
                <h4>Primary KAM Areas:</h4>
                <ul>
                    <li><strong>Investment Management Technology:</strong> SimCorp platform integration</li>
                    <li><strong>Post-Trade Services:</strong> Clearstream expansion</li>
                    <li><strong>Data Analytics:</strong> Qontigo and ISS integration</li>
                    <li><strong>Regulatory Technology:</strong> Compliance automation</li>
                </ul>
            </div>

            <div class="exchange-card">
                <div class="exchange-name">üá≠üá∞ HKEX (Hong Kong Exchanges and Clearing)</div>
                <div class="kam-count">18 KAMs (13.7%)</div>
                <h4>Asia-Pacific Gateway:</h4>
                <ul>
                    <li><strong>2018-2022:</strong> Optiq trading platform implementation</li>
                    <li><strong>2020-2024:</strong> China market connectivity expansion</li>
                </ul>
                <h4>Key Developments:</h4>
                <ul>
                    <li><strong>Technology Platform:</strong> Optiq rollout across markets</li>
                    <li><strong>China Connect:</strong> Stock and Bond Connect expansion</li>
                    <li><strong>Market Structure:</strong> Maker/taker fee models</li>
                    <li><strong>ESG Integration:</strong> Green finance initiatives</li>
                </ul>
            </div>
        </section>

        <section id="insights" class="section">
            <h2>üí° Key Insights & Future Outlook</h2>

            <div class="chart-container">
                <canvas id="riskEvolutionChart"></canvas>
            </div>

            <div class="highlight-box">
                <h3>üéØ Critical Insights</h3>
                <h4>1. Consolidation Impact</h4>
                <ul>
                    <li><strong>2021 Peak:</strong> Mega-acquisitions created unprecedented KAM complexity</li>
                    <li><strong>Integration Focus:</strong> 2022-2024 dominated by post-acquisition integration</li>
                    <li><strong>Technology Convergence:</strong> Platform consolidation driving ongoing complexity</li>
                </ul>

                <h4>2. Technology Transformation</h4>
                <ul>
                    <li><strong>AI/ML Adoption:</strong> Increasing focus on automation and analytics</li>
                    <li><strong>Cloud Migration:</strong> Infrastructure modernization creating valuation challenges</li>
                    <li><strong>Cybersecurity:</strong> Growing emphasis on security and resilience</li>
                </ul>

                <h4>3. Regulatory Evolution</h4>
                <ul>
                    <li><strong>Cross-Border Complexity:</strong> Multi-jurisdictional operations increasing compliance burden</li>
                    <li><strong>ESG Integration:</strong> Sustainability reporting becoming material</li>
                    <li><strong>Market Structure:</strong> Ongoing reforms affecting revenue models</li>
                </ul>
            </div>

            <div class="phase-header">
                <h3>üîÆ Future Outlook (2025+)</h3>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">üìà</div>
                    <div class="stat-label">Stabilization Expected<br>Post-acquisition integration completing</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">ü§ñ</div>
                    <div class="stat-label">Technology Focus<br>AI and automation deployment</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">‚öñÔ∏è</div>
                    <div class="stat-label">Regulatory Adaptation<br>Ongoing compliance evolution</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">üöÄ</div>
                    <div class="stat-label">Market Innovation<br>New products and services</div>
                </div>
            </div>
        </section>
    </div>

    <script src="actual_kam_data.js"></script>
    <script>
        // Initialize data
        const kamData = ACTUAL_KAM_DATA;

        // Helper function to assess risk severity
        function assessRiskSeverity(kamTitle, description) {
            const highRiskKeywords = ['impairment', 'goodwill', 'significant judgment', 'material uncertainty',
                                    'going concern', 'fraud', 'litigation', 'regulatory', 'compliance',
                                    'material weakness', 'significant deficiency'];

            const mediumRiskKeywords = ['valuation', 'estimate', 'fair value', 'provision', 'tax',
                                      'acquisition', 'restructuring', 'credit risk', 'market risk'];

            const text = (kamTitle + ' ' + description).toLowerCase();

            if (highRiskKeywords.some(keyword => text.includes(keyword))) {
                return 'high';
            }

            if (mediumRiskKeywords.some(keyword => text.includes(keyword))) {
                return 'medium';
            }

            return 'low';
        }

        // Create overview chart
        function createOverviewChart() {
            const ctx = document.getElementById('overviewChart').getContext('2d');

            // Year distribution
            const yearData = {};
            kamData.forEach(item => {
                yearData[item.year] = (yearData[item.year] || 0) + 1;
            });

            const years = Object.keys(yearData).sort();
            const counts = years.map(year => yearData[year]);

            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: years,
                    datasets: [{
                        label: 'KAMs per Year',
                        data: counts,
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#3498db',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'KAM Distribution Over Time (2015-2024)',
                            font: { size: 16, weight: 'bold' }
                        },
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Number of KAMs'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Year'
                            }
                        }
                    }
                }
            });
        }

        // Create year trend chart with phases
        function createYearTrendChart() {
            const ctx = document.getElementById('yearTrendChart').getContext('2d');

            const yearData = {};
            kamData.forEach(item => {
                yearData[item.year] = (yearData[item.year] || 0) + 1;
            });

            const years = Object.keys(yearData).sort();
            const counts = years.map(year => yearData[year]);

            // Phase colors
            const phaseColors = years.map(year => {
                if (year <= 2017) return 'rgba(155, 89, 182, 0.8)'; // Phase 1: Purple
                if (year <= 2020) return 'rgba(52, 152, 219, 0.8)'; // Phase 2: Blue
                if (year <= 2023) return 'rgba(231, 76, 60, 0.8)';  // Phase 3: Red
                return 'rgba(46, 204, 113, 0.8)';                   // Phase 4: Green
            });

            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: years,
                    datasets: [{
                        label: 'KAMs per Year',
                        data: counts,
                        backgroundColor: phaseColors,
                        borderColor: phaseColors.map(color => color.replace('0.8', '1')),
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'KAM Trends by Phase (Color-Coded)',
                            font: { size: 16, weight: 'bold' }
                        },
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Number of KAMs'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Year'
                            }
                        }
                    }
                }
            });
        }

        // Create company distribution chart
        function createCompanyDistributionChart() {
            const ctx = document.getElementById('companyDistributionChart').getContext('2d');

            const companyData = {};
            kamData.forEach(item => {
                companyData[item.company] = (companyData[item.company] || 0) + 1;
            });

            const companies = Object.keys(companyData);
            const counts = Object.values(companyData);

            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: companies,
                    datasets: [{
                        data: counts,
                        backgroundColor: [
                            '#3498db', '#e74c3c', '#f39c12', '#2ecc71',
                            '#9b59b6', '#1abc9c', '#34495e'
                        ],
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'KAM Distribution by Exchange',
                            font: { size: 16, weight: 'bold' }
                        },
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        // Create phase analysis chart
        function createPhaseChart() {
            const ctx = document.getElementById('phaseChart').getContext('2d');

            const phaseData = {
                'Phase 1 (2015-2017)': 0,
                'Phase 2 (2018-2020)': 0,
                'Phase 3 (2021-2023)': 0,
                'Phase 4 (2024)': 0
            };

            kamData.forEach(item => {
                if (item.year <= 2017) phaseData['Phase 1 (2015-2017)']++;
                else if (item.year <= 2020) phaseData['Phase 2 (2018-2020)']++;
                else if (item.year <= 2023) phaseData['Phase 3 (2021-2023)']++;
                else phaseData['Phase 4 (2024)']++;
            });

            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(phaseData),
                    datasets: [{
                        label: 'KAMs per Phase',
                        data: Object.values(phaseData),
                        backgroundColor: [
                            'rgba(155, 89, 182, 0.8)',  // Purple
                            'rgba(52, 152, 219, 0.8)',  // Blue
                            'rgba(231, 76, 60, 0.8)',   // Red
                            'rgba(46, 204, 113, 0.8)'   // Green
                        ],
                        borderColor: [
                            'rgba(155, 89, 182, 1)',
                            'rgba(52, 152, 219, 1)',
                            'rgba(231, 76, 60, 1)',
                            'rgba(46, 204, 113, 1)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'KAM Distribution Across Four Phases',
                            font: { size: 16, weight: 'bold' }
                        },
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Number of KAMs'
                            }
                        }
                    }
                }
            });
        }

        // Create exchange KAM chart
        function createExchangeKAMChart() {
            const ctx = document.getElementById('exchangeKAMChart').getContext('2d');

            const exchangeData = {};
            kamData.forEach(item => {
                exchangeData[item.company] = (exchangeData[item.company] || 0) + 1;
            });

            // Sort by count
            const sortedExchanges = Object.entries(exchangeData)
                .sort(([,a], [,b]) => b - a);

            new Chart(ctx, {
                type: 'horizontalBar',
                data: {
                    labels: sortedExchanges.map(([name]) => name),
                    datasets: [{
                        label: 'Total KAMs',
                        data: sortedExchanges.map(([,count]) => count),
                        backgroundColor: 'rgba(52, 152, 219, 0.8)',
                        borderColor: 'rgba(52, 152, 219, 1)',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    plugins: {
                        title: {
                            display: true,
                            text: 'KAM Count by Exchange',
                            font: { size: 16, weight: 'bold' }
                        },
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Number of KAMs'
                            }
                        }
                    }
                }
            });
        }

        // Create risk severity chart
        function createRiskSeverityChart() {
            const ctx = document.getElementById('riskSeverityChart').getContext('2d');

            const riskData = { high: 0, medium: 0, low: 0 };

            kamData.forEach(item => {
                const risk = assessRiskSeverity(item.kamTitle, item.description);
                riskData[risk]++;
            });

            new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['High Risk', 'Medium Risk', 'Low Risk'],
                    datasets: [{
                        data: [riskData.high, riskData.medium, riskData.low],
                        backgroundColor: [
                            'rgba(231, 76, 60, 0.8)',   // Red
                            'rgba(243, 156, 18, 0.8)',  // Orange
                            'rgba(46, 204, 113, 0.8)'   // Green
                        ],
                        borderColor: [
                            'rgba(231, 76, 60, 1)',
                            'rgba(243, 156, 18, 1)',
                            'rgba(46, 204, 113, 1)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Risk Severity Distribution',
                            font: { size: 16, weight: 'bold' }
                        },
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        // Create risk evolution chart
        function createRiskEvolutionChart() {
            const ctx = document.getElementById('riskEvolutionChart').getContext('2d');

            const yearRiskData = {};

            kamData.forEach(item => {
                if (!yearRiskData[item.year]) {
                    yearRiskData[item.year] = { high: 0, medium: 0, low: 0 };
                }
                const risk = assessRiskSeverity(item.kamTitle, item.description);
                yearRiskData[item.year][risk]++;
            });

            const years = Object.keys(yearRiskData).sort();

            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: years,
                    datasets: [{
                        label: 'High Risk',
                        data: years.map(year => yearRiskData[year].high),
                        borderColor: 'rgba(231, 76, 60, 1)',
                        backgroundColor: 'rgba(231, 76, 60, 0.1)',
                        borderWidth: 3,
                        fill: false,
                        tension: 0.4
                    }, {
                        label: 'Medium Risk',
                        data: years.map(year => yearRiskData[year].medium),
                        borderColor: 'rgba(243, 156, 18, 1)',
                        backgroundColor: 'rgba(243, 156, 18, 0.1)',
                        borderWidth: 3,
                        fill: false,
                        tension: 0.4
                    }, {
                        label: 'Low Risk',
                        data: years.map(year => yearRiskData[year].low),
                        borderColor: 'rgba(46, 204, 113, 1)',
                        backgroundColor: 'rgba(46, 204, 113, 0.1)',
                        borderWidth: 3,
                        fill: false,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Risk Severity Evolution Over Time',
                            font: { size: 16, weight: 'bold' }
                        },
                        legend: {
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Number of KAMs'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Year'
                            }
                        }
                    }
                }
            });
        }

        // Initialize all charts when page loads
        document.addEventListener('DOMContentLoaded', function() {
            createOverviewChart();
            createYearTrendChart();
            createCompanyDistributionChart();
            createPhaseChart();
            createExchangeKAMChart();
            createRiskSeverityChart();
            createRiskEvolutionChart();
        });
    </script>
</body>
</html>
